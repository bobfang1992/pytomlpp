# PyTomlpp Improvement TODO List

Generated: 2025-11-29

## ðŸ”¥ High Priority (Fix Soon)

### GitHub Actions - Breaking Changes Coming
- [ ] Fix deprecated `set-output` in `.github/workflows/dists.yml:44`
  - Replace: `echo "::set-output name=dir::$(pip cache dir)"`
  - With: `echo "dir=$(pip cache dir)" >> $GITHUB_OUTPUT`

- [ ] Update GitHub Actions versions
  - `actions/checkout@v3` â†’ `@v4`
  - `actions/setup-python@v3` â†’ `@v5`

### Type Hints & Documentation
- [ ] Complete type stubs in `src/pytomlpp/_impl.pyi`
  ```python
  def loads(data: str) -> dict[str, Any]: ...
  def dumps(data: dict[str, Any]) -> str: ...
  class DecodeError(Exception):
      err_message: str
      start_line: int
      start_col: int
      end_line: int
      end_col: int
      path: str | None
  ```

- [ ] Fix typos in docstrings (`src/pytomlpp/_io.py`)
  - Line 18: "seralised" â†’ "serialised"
  - Lines 30-31, 61-62: "enconding" â†’ "encoding"

- [ ] Add `CHANGELOG.md` for version history tracking

### Dependencies
- [ ] Update pybind11 in `setup.cfg:33`
  - From: `pybind11~=2.10`
  - To: `pybind11>=2.10,<3.0`

- [ ] Update conda recipe (`conda.recipe/meta.yaml:16`)
  - From: `pybind11=2.5`
  - To: `pybind11>=2.10`

### Modern Python Packaging
- [ ] Migrate to `pyproject.toml` (PEP 517/518)
  - Deprecate `setup.py` / `setup.cfg`
  - Add proper build backend configuration
  - Fix license classifier deprecation warning

---

## ðŸ“‹ Medium Priority (Next Release)

### Code Cleanup
- [ ] Remove Python 2 compatibility code
  - `tests/python-tests/test_api.py:1` - Remove `from __future__ import print_function`
  - `tests/python-tests/test_api.py:8-10` - Remove `pathlib2` fallback

- [ ] Add `__version__` to `src/pytomlpp/__init__.py`
  ```python
  __version__ = "1.1.0"  # sync with setup.cfg
  ```

- [ ] Fix typo in `setup.cfg:29`
  - "serilization" â†’ "serialization"

### Testing
- [ ] Add missing test coverage
  - `DecodeError` attributes (line, column, path)
  - `encoding` parameter functionality
  - `os.PathLike` support
  - Edge cases: empty files, very large files, Unicode in keys

- [ ] Add test dependencies to `tests/requirements.txt`
  - `pytest>=7.0.0`
  - `python-dateutil>=2.8.0`
  - `pytest-cov` (for coverage)
  - `pytest-xdist` (for parallel testing)

### CI/CD Improvements
- [ ] Update `cibuildwheel` from `3.0.0` to latest (`~3.21.0`)
- [ ] Add code coverage reporting to CI
- [ ] Add Linux ARM64 builds (`CIBW_ARCHS_LINUX`)

### Documentation
- [ ] Create `CONTRIBUTING.md`
  - Development setup instructions
  - How to run tests locally
  - Code style requirements
  - PR process

- [ ] Enhance README.md
  - Document `encoding` parameter
  - Add `DecodeError` examples
  - Add migration guide from other TOML libraries
  - Document `lib_version` attribute

### Code Quality
- [ ] Refactor duplicated datetime imports in `src/encoding_decoding.cpp`
  - Lines 36-40 and 84-88 are identical
  - Extract to static cached objects

- [ ] Add pre-commit hooks
  - black/ruff for formatting
  - mypy for type checking
  - isort for imports

---

## ðŸš€ Low Priority (Future Enhancements)

### Features
- [ ] Add `__all__` exports to `src/pytomlpp/__init__.py`
- [ ] Add validation-only mode (validate without parsing)
- [ ] Add formatting options to `dumps()` (indent, width)
- [ ] Consider async I/O support (`aload()`, `adump()`)
- [ ] Consider streaming support for large files
- [ ] Add dataclass integration helpers

### Performance
- [ ] Cache datetime module imports at module level
- [ ] Add LTO (Link Time Optimization) flags for builds
- [ ] Add performance regression tests

### Development
- [ ] Add Sphinx/MkDocs API documentation
- [ ] Add mypy/pyright to CI
- [ ] Add ruff/pylint linting to CI
- [ ] Add Dependabot for automated dependency updates
- [ ] Add property-based testing with Hypothesis

### Exception Handling
- [ ] Consider exception hierarchy
  - Add `EncodeError` for serialization failures
  - Add base `PyTomlppError` class

---

## ðŸ“Š Statistics

- **Total issues identified**: 50+
- **High priority**: 7 items
- **Medium priority**: 15 items
- **Low priority**: 13+ items
- **Estimated effort**: 2-3 sprints for high+medium priorities

---

## ðŸŽ¯ Quick Wins (< 30 minutes each)

1. Fix GitHub Actions `set-output` deprecation
2. Fix docstring typos
3. Add `__version__` attribute
4. Update pybind11 version constraints
5. Remove Python 2 compatibility imports
6. Fix `setup.cfg` typo

---

## ðŸ“ Notes

- **License warning**: Already noted to fix in separate PR
- **MSVC fixes**: Already completed in v1.1.0
- **Python 3.12/3.13/3.14 support**: Already added in v1.1.0
- **toml++ version**: Currently on latest master (good!)

---

*Last updated: 2025-11-29*
*Generated by Claude Code analysis*
